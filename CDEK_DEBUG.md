# üîß –û—Ç–ª–∞–¥–∫–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –°–î–≠–ö API

## ‚úÖ –ß—Ç–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ

### 1. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤–æ–π —Å—Ä–µ–¥—ã –°–î–≠–ö
- **–¢–µ—Å—Ç–æ–≤—ã–π URL**: `https://api.edu.cdek.ru/v2`
- **Production URL**: `https://api.cdek.ru/v2`
- –¢–µ–∫—É—â–∏–π —Ä–µ–∂–∏–º: **–¢–ï–°–¢–û–í–´–ô** (–ø–µ—Ä–µ–∫–ª—é—á–∞–µ—Ç—Å—è –≤ `cdek-service.js`)

### 2. –î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
–¢–µ–ø–µ—Ä—å –≤ –∫–æ–Ω—Å–æ–ª–∏ —Å–µ—Ä–≤–µ—Ä–∞ –≤–∏–¥–Ω–æ:
- üîë –ü—Ä–æ—Ü–µ—Å—Å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
- üì§ –í—Å–µ –∑–∞–ø—Ä–æ—Å—ã –∫ –°–î–≠–ö API —Å –¥–∞–Ω–Ω—ã–º–∏
- üì• –í—Å–µ –æ—Ç–≤–µ—Ç—ã –æ—Ç –°–î–≠–ö API
- ‚ùå –î–µ—Ç–∞–ª—å–Ω—ã–µ –æ—à–∏–±–∫–∏ —Å HTTP —Å—Ç–∞—Ç—É—Å–∞–º–∏

### 3. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–∏—Å–∫ –∫–æ–¥–∞ –≥–æ—Ä–æ–¥–∞
–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—â–µ—Ç –∫–æ–¥ –≥–æ—Ä–æ–¥–∞ –≤ –±–∞–∑–µ –°–î–≠–ö –ø–µ—Ä–µ–¥ —Ä–∞—Å—á–µ—Ç–æ–º –¥–æ—Å—Ç–∞–≤–∫–∏.

### 4. –î–≤–∞ –º–µ—Ç–æ–¥–∞ —Ä–∞—Å—á–µ—Ç–∞
- **tarifflist** (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é) - –ø–æ–ª—É—á–∞–µ—Ç –í–°–ï –¥–æ—Å—Ç—É–ø–Ω—ã–µ —Ç–∞—Ä–∏—Ñ—ã
- **tariff** - —Ä–∞—Å—á–µ—Ç –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Ç–∞—Ä–∏—Ñ–∞

### 5. –ö–Ω–æ–ø–∫–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
–î–æ–±–∞–≤–ª–µ–Ω–∞ –∫–Ω–æ–ø–∫–∞ **"üß™ –¢–µ—Å—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –°–î–≠–ö API"** –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–æ–≤–µ—Ä—è–µ—Ç:
- ‚úÖ –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é
- ‚úÖ –ü–æ–∏—Å–∫ –≥–æ—Ä–æ–¥–æ–≤
- ‚úÖ –†–∞—Å—á–µ—Ç –¥–æ—Å—Ç–∞–≤–∫–∏

---

## üöÄ –ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ API —Ä–∞–±–æ—Ç–∞–µ—Ç

### –®–∞–≥ 1: –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä
```bash
npm start
```

### –®–∞–≥ 2: –û—Ç–∫—Ä–æ–π—Ç–µ http://localhost:3000

### –®–∞–≥ 3: –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ –≤–∫–ª–∞–¥–∫—É "–î–æ—Å—Ç–∞–≤–∫–∞"

### –®–∞–≥ 4: –ù–∞–∂–º–∏—Ç–µ "üß™ –¢–µ—Å—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –°–î–≠–ö API"

### –®–∞–≥ 5: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å —Å–µ—Ä–≤–µ—Ä–∞

–í—ã –¥–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å:
```
üîß –°–î–≠–ö Service –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω:
   –†–µ–∂–∏–º: –¢–ï–°–¢–û–í–´–ô
   URL: https://api.edu.cdek.ru/v2
   Client ID: EMscd6r9JnFiQ3bLoyjJY6eM78JrJceI

üß™ === –¢–ï–°–¢ –ü–û–î–ö–õ–Æ–ß–ï–ù–ò–Ø –ö –°–î–≠–ö API ===

1Ô∏è‚É£ –¢–µ—Å—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏...
üîë –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞ –°–î–≠–ö API...
‚úÖ –¢–æ–∫–µ–Ω –ø–æ–ª—É—á–µ–Ω —É—Å–ø–µ—à–Ω–æ

2Ô∏è‚É£ –¢–µ—Å—Ç –ø–æ–∏—Å–∫–∞ –≥–æ—Ä–æ–¥–æ–≤ (–ú–æ—Å–∫–≤–∞)...
‚úÖ –ù–∞–π–¥–µ–Ω–æ –≥–æ—Ä–æ–¥–æ–≤: X

3Ô∏è‚É£ –¢–µ—Å—Ç —Ä–∞—Å—á–µ—Ç–∞ –¥–æ—Å—Ç–∞–≤–∫–∏ (–ú–æ—Å–∫–≤–∞ ‚Üí –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥)...
üì¶ –°–î–≠–ö –∑–∞–ø—Ä–æ—Å —Å–ø–∏—Å–∫–∞ —Ç–∞—Ä–∏—Ñ–æ–≤: {...}
‚úÖ –°–î–≠–ö –æ—Ç–≤–µ—Ç (—Å–ø–∏—Å–æ–∫ —Ç–∞—Ä–∏—Ñ–æ–≤): {...}
‚úÖ –ü–æ–ª—É—á–µ–Ω–æ —Ç–∞—Ä–∏—Ñ–æ–≤: X

‚úÖ === –í–°–ï –¢–ï–°–¢–´ –ó–ê–í–ï–†–®–ï–ù–´ ===
```

---

## üîç –ï—Å–ª–∏ API –≤—Å–µ –µ—â–µ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

### –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –≤ –∫–æ–Ω—Å–æ–ª–∏ —Å–µ—Ä–≤–µ—Ä–∞:

#### 1. –û—à–∏–±–∫–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ (401)
```
‚ùå –û—à–∏–±–∫–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –°–î–≠–ö:
   –°—Ç–∞—Ç—É—Å: 401
```
**–†–µ—à–µ–Ω–∏–µ**: –ù–µ–≤–µ—Ä–Ω—ã–µ credentials. –î–ª—è —Ç–µ—Å—Ç–æ–≤–æ–≥–æ API –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ:
- Client ID: `EMscd6r9JnFiQ3bLoyjJY6eM78JrJceI`
- Client Secret: `PjLZkKBHEiLK3YsjtNrt3TGNG0ahs3kG`
- URL: `https://api.edu.cdek.ru/v2`

#### 2. –ì–æ—Ä–æ–¥ –Ω–µ –Ω–∞–π–¥–µ–Ω
```
‚ùå –ì–æ—Ä–æ–¥ "..." –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ –±–∞–∑–µ –°–î–≠–ö
```
**–†–µ—à–µ–Ω–∏–µ**: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–æ—á–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –≥–æ—Ä–æ–¥–∞ (–ú–æ—Å–∫–≤–∞, –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥, –ù–æ–≤–æ—Å–∏–±–∏—Ä—Å–∫ –∏ —Ç.–¥.)

#### 3. Timeout –æ—à–∏–±–∫–∞
```
ECONNABORTED: timeout of 15000ms exceeded
```
**–†–µ—à–µ–Ω–∏–µ**: 
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ
- API –°–î–≠–ö –º–æ–∂–µ—Ç –±—ã—Ç—å –≤—Ä–µ–º–µ–Ω–Ω–æ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω
- –£–≤–µ–ª–∏—á—å—Ç–µ timeout –≤ `cdek-service.js`

#### 4. –ù–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Ç–∞—Ä–∏—Ñ–æ–≤
```
‚ùå –°–î–≠–ö –Ω–µ –≤–µ—Ä–Ω—É–ª —Ç–∞—Ä–∏—Ñ–æ–≤
```
**–†–µ—à–µ–Ω–∏–µ**: 
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –≥–æ—Ä–æ–¥ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π
- –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –°–î–≠–ö
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ - –≤–æ–∑–º–æ–∂–Ω–æ API –≤–µ—Ä–Ω—É–ª –æ—à–∏–±–∫—É

---

## üìù –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∑–∞–ø—Ä–æ—Å–∞ –∫ –°–î–≠–ö API

### –†–∞—Å—á–µ—Ç —Å–ø–∏—Å–∫–∞ —Ç–∞—Ä–∏—Ñ–æ–≤
```javascript
POST https://api.edu.cdek.ru/v2/calculator/tarifflist
Authorization: Bearer <token>
Content-Type: application/json

{
  "type": 1,           // –¢–∏–ø –∑–∞–∫–∞–∑–∞ (1 - –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-–º–∞–≥–∞–∑–∏–Ω)
  "currency": 1,       // –í–∞–ª—é—Ç–∞ (1 - —Ä—É–±–ª—å)
  "lang": "rus",       // –Ø–∑—ã–∫ –æ—Ç–≤–µ—Ç–∞
  "from_location": {
    "code": 44         // –ú–æ—Å–∫–≤–∞
  },
  "to_location": {
    "code": 137        // –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥
  },
  "packages": [{
    "weight": 1000,    // –í–µ—Å –≤ –≥—Ä–∞–º–º–∞—Ö
    "length": 30,      // –î–ª–∏–Ω–∞ –≤ —Å–º
    "width": 20,       // –®–∏—Ä–∏–Ω–∞ –≤ —Å–º
    "height": 10       // –í—ã—Å–æ—Ç–∞ –≤ —Å–º
  }]
}
```

### –û–∂–∏–¥–∞–µ–º—ã–π –æ—Ç–≤–µ—Ç
```json
{
  "tariff_codes": [
    {
      "tariff_code": 136,
      "tariff_name": "–ü–æ—Å—ã–ª–∫–∞ –¥–≤–µ—Ä—å-–¥–≤–µ—Ä—å",
      "tariff_description": "...",
      "delivery_mode": 1,
      "delivery_sum": 450,
      "period_min": 2,
      "period_max": 4
    }
  ]
}
```

---

## üéØ Endpoints –¥–ª—è —Ä—É—á–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏

### 1. –¢–µ—Å—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
```bash
curl http://localhost:3000/api/delivery/test
```

### 2. –ü–æ–∏—Å–∫ –≥–æ—Ä–æ–¥–æ–≤
```bash
curl "http://localhost:3000/api/delivery/cities?query=–ú–æ—Å–∫–≤–∞"
```

### 3. –†–∞—Å—á–µ—Ç –¥–æ—Å—Ç–∞–≤–∫–∏
```bash
curl -X POST http://localhost:3000/api/delivery/calculate \
  -H "Content-Type: application/json" \
  -d '{
    "city": "–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥",
    "deliveryType": "door",
    "weight": 1000
  }'
```

---

## üìö –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏

- **–¢–µ—Å—Ç–æ–≤–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è**: https://api-docs.cdek.ru/
- **–¢–µ—Å—Ç–æ–≤–∞—è —Å—Ä–µ–¥–∞**: https://api.edu.cdek.ru/v2
- **Production —Å—Ä–µ–¥–∞**: https://api.cdek.ru/v2
- **–õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç**: https://lk.cdek.ru/

---

## ‚öôÔ∏è –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞ Production

–í —Ñ–∞–π–ª–µ `cdek-service.js` –∏–∑–º–µ–Ω–∏—Ç–µ:

```javascript
constructor() {
    this.testMode = false; // –ë—ã–ª–æ: true
    // ...
}
```

–ò —É–∫–∞–∂–∏—Ç–µ –≤–∞—à–∏ production credentials:
```javascript
this.credentials = {
    client_id: '–í–ê–®_CLIENT_ID',
    client_secret: '–í–ê–®_CLIENT_SECRET'
};
```

–ò–ª–∏ —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:
```bash
CDEK_CLIENT_ID=–≤–∞—à_id
CDEK_CLIENT_SECRET=–≤–∞—à_secret
```

---

## ‚úÖ –ß–µ–∫–ª–∏—Å—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏

- [ ] –°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω (`npm start`)
- [ ] –í –∫–æ–Ω—Å–æ–ª–∏ –≤–∏–¥–Ω–æ `–°–î–≠–ö Service –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω`
- [ ] –ö–Ω–æ–ø–∫–∞ "–¢–µ—Å—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è" –Ω–∞–∂–∞—Ç–∞
- [ ] –í –∫–æ–Ω—Å–æ–ª–∏ –≤–∏–¥–Ω—ã –ø–æ–¥—Ä–æ–±–Ω—ã–µ –ª–æ–≥–∏
- [ ] –¢–æ–∫–µ–Ω –ø–æ–ª—É—á–µ–Ω —É—Å–ø–µ—à–Ω–æ
- [ ] –ì–æ—Ä–æ–¥–∞ –Ω–∞–π–¥–µ–Ω—ã
- [ ] –¢–∞—Ä–∏—Ñ—ã –ø–æ–ª—É—á–µ–Ω—ã
- [ ] –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç

–ï—Å–ª–∏ –≤—Å–µ –ø—É–Ω–∫—Ç—ã –≤—ã–ø–æ–ª–Ω–µ–Ω—ã - **–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç!** ‚úÖ

